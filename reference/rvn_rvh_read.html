<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Read Raven .rvh (watershed discretization) file — rvn_rvh_read • RavenR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Read Raven .rvh (watershed discretization) file — rvn_rvh_read"><meta property="og:description" content="This routine reads in a valid Raven watershed discretization (.rvh) file and returns the
information about HRUs and Subbasins as data tables. It also returns a subbasin igraph
network object which describes stream network connectivity and adds additional HRU-derived
subbasin characteristics such as total upstream area and dominant land/vegetation classes."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RavenR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Introduction_to_RavenR.html">Introduction to RavenR</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/rchlumsk/RavenR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Read Raven .rvh (watershed discretization) file</h1>
    <small class="dont-index">Source: <a href="https://github.com/rchlumsk/RavenR/blob/HEAD/R/rvn_rvh_read.R" class="external-link"><code>R/rvn_rvh_read.R</code></a></small>
    <div class="hidden name"><code>rvn_rvh_read.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This routine reads in a valid Raven watershed discretization (.rvh) file and returns the
information about HRUs and Subbasins as data tables. It also returns a subbasin igraph
network object which describes stream network connectivity and adds additional HRU-derived
subbasin characteristics such as total upstream area and dominant land/vegetation classes.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rvn_rvh_read</span><span class="op">(</span><span class="va">ff</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>ff</dt>
<dd><p>the filepath of the .rvh file (with .rvh extension included).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Returns a list including:</p>
<dl><dt>SBtable</dt>
<dd><p>a data table of Subbasin characteristics indexed by Subbasin ID (SBID). Includes
the following data columns from the .rvh file : SBID, Name, Downstream_ID, Profile, ReachLength,
Gauged. The rvn_rvh_read() functions supplements this with additional columns: Area, Elevation, AvgLatit,
AvgLongit, AvgSlope, AvgAspect, DomLU, DomLUArea, DomLUFrac, DomVeg, DomVegArea, DomVegFrac.
Elevation, AvgLatit, AvgLongit, AvgSlope, and AvgAspect are the area-weighted averages from all
constituent HRUs. DomLU is the dominant land use name, DomLUArea is the area (in km2) of the
dominant land use and DomLUArea is the percentage of the basin covered with DomLU; same applies to DomVeg.</p></dd>


<dt>HRUtable</dt>
<dd><p>a data table of HRU characteristics, with land use and vegetation classes as factors.
Contains identical information as found in the :HRUs-:EndHRUs block of the .rvh file: ID, Area,
Elevation, Latitude, Longitude, SBID, LandUse,Vegetation, SoilProfile, Aquifer, Terrain, Slope,
and Aspect.</p></dd>


<dt>SBnetwork</dt>
<dd><p>an igraph network graph network describing subbasin stream network connectivity,
with nodes indexed by SBID.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The supplied file should not be comma-delimited with a trailing comma. The function also
does not like tabs in the rvh file, the file should be untabified first.
This function uses the igraph library to build the networks and compute the total upstream area.
The .rvh file can have arbitrary contents outside of the :HRUs-:EndHRUs and :SubBasins-:EndSubBasins
command blocks.</p>
<p>Partial rvh files may be provided to this function (i.e. with only :SubBasin or :HRUs blocks but not the other),
however, some calculations and the calculation of the <code>SBnetwork</code> output will not be completed. Omitted
structures (e.g. <code>SBtable</code>) will be returned as <code>NULL</code> if the section is not found in the rvh file directly.
Note that this function does not look for additional files specified with <code>:RedirectToFile</code> commands.</p>
<p>The ff argument can be a relative path name or absolute one.</p>
<p>The TotalUpstreamArea is the total drainage area upstream of the given subbasin outlet. With this calculation,
headerwater subbasins will have a total upstream area equal to their own subbasin area.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="rvn_rvh_write.html">rvn_rvh_write</a></code> to write contents of the generated (and usually modified HRU and SubBasin tables)
<code><a href="rvn_rvh_subbasin_network_plot.html">rvn_rvh_subbasin_network_plot</a></code> to plot the subbasin network</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>James R. Craig, University of Waterloo</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># load example rvh file</span></span></span>
<span class="r-in"><span>  <span class="va">nith</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,<span class="st">"Nith.rvh"</span>,package <span class="op">=</span> <span class="st">"RavenR"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">rvh</span> <span class="op">&lt;-</span> <span class="fu">rvn_rvh_read</span><span class="op">(</span><span class="va">nith</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># number of HRUs</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">rvh</span><span class="op">$</span><span class="va">HRUtable</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 32</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># total watershed area</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">rvh</span><span class="op">$</span><span class="va">HRUtable</span><span class="op">$</span><span class="va">Area</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1014.4</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># sub-table of headwater basins (upstream area = subbasin area)</span></span></span>
<span class="r-in"><span>  <span class="va">rvh</span><span class="op">$</span><span class="va">SBtable</span><span class="op">$</span><span class="va">SBID</span><span class="op">[</span><span class="va">rvh</span><span class="op">$</span><span class="va">SBtable</span><span class="op">$</span><span class="va">Area</span> <span class="op">==</span> <span class="va">rvh</span><span class="op">$</span><span class="va">SBtable</span><span class="op">$</span><span class="va">TotalUpstreamArea</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 30</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># sub-table of Urban HRUs</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">rvh</span><span class="op">$</span><span class="va">HRUtable</span>, <span class="va">LandUse</span> <span class="op">==</span> <span class="st">"URBAN"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ID Area Elevation Latitude Longitude SBID LandUse Vegetation SoilProfile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 24  6.9       346    43.38    -80.61   39   URBAN     URBAN1   SOILPROFA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 32  5.3       299    43.29    -80.45   43   URBAN     URBAN1   SOILPROFA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Aquifer Terrain Slope Aspect</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  [NONE]  [NONE]  1.67    182</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32  [NONE]  [NONE]  1.35    171</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># get total area upstream of subbasin containing outlet</span></span></span>
<span class="r-in"><span>  <span class="va">upstr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">rvh</span><span class="op">$</span><span class="va">SBtable</span><span class="op">$</span><span class="va">Area</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">upstr</span><span class="op">[</span><span class="va">rvh</span><span class="op">$</span><span class="va">SBtable</span><span class="op">$</span><span class="va">Downstream_ID</span> <span class="op">==</span> <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1014.4</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># show upstream areas for each subbasin</span></span></span>
<span class="r-in"><span>  <span class="va">rvh</span><span class="op">$</span><span class="va">SBtable</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SBID"</span>,<span class="st">"TotalUpstreamArea"</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    SBID TotalUpstreamArea</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30   30             318.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36   36             537.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39   39             809.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43   43            1014.4</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># plot network diagram using igraph library</span></span></span>
<span class="r-in"><span>  <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/plot.igraph.html" class="external-link">plot.igraph</a></span><span class="op">(</span><span class="va">rvh</span><span class="op">$</span><span class="va">SBnetwork</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="rvn_rvh_read-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Robert Chlumsky, James Craig, Leland Scantlebury, Simon Lin, Sarah Grass, Genevieve Brown, Rezgar Arabzadeh.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

